import{l as L,_ as U}from"./app.C9BwLGJy.js";import"./chunks/pinia.C8xpNjyg.js";import{M as j,v as K,y as W,x as f,K as c,a3 as g,R as z,a2 as m,a6 as S,T,a1 as A,a4 as y,a8 as b,ac as x,V as w,aj as O,ah as D,a7 as N,ag as h,a5 as R,S as q,G as J,H as V,a0 as Q,$ as Z}from"./framework.DIhz9aLV.js";import"./chunks/dayjs.BsdSHi3w.js";function E(a){if(typeof a=="string")return a;if(Array.isArray(a)&&a.length>0)return a[Math.floor(Math.random()*a.length)]}function ye(a){return/\.(?:mp4|webm|ogg)$/i.test(a)}const M="success",P="error",ee=10,te=.5625,ae=.2,re=Symbol("globalOptions");function le(a){let e=new Image,u=f(0),l=f(0),t=c(()=>u.value?l.value/u.value:te),o=setInterval(()=>{e?.width&&(clearInterval(o),u.value=e.width,l.value=e.height)},ee),d=i=>{let r=document.createElement("canvas");r.width=1,r.height=1,r.setAttribute("hidden","true"),document.body.appendChild(r),r.getContext("2d")?.drawImage(i,0,0),document.body.removeChild(r)};async function p(){let i=w(a);if(!i)return;let r=i.src;if(e.src=r,!e.complete)return new Promise((s,n)=>{e.onload=()=>{d(i),V(()=>s())},e.onerror=n})}return{width:u,height:l,aspectRatio:t,loadImage:p}}function oe(a){let e=f(!1),u={threshold:ae},l=new IntersectionObserver(o=>{o[0].isIntersecting&&(e.value=!0,l.disconnect())},u),t=o=>{let d=J(e,p=>{p&&(V().then(o),d())},{immediate:!0})};return z(()=>{let o=w(a);o&&l.observe(o)}),q(()=>{l.disconnect()}),{watchIntersectionOnce:t,isIntersected:e}}const se=["src","alt","title"],ne=["alt","loading","src"],ie={key:1,class:"v-progressive-image-slot-default"};var ue=j({__name:"ProgressiveImage",props:{src:{},placeholderSrc:{},fallbackSrc:{},alt:{},title:{},customClass:{},blur:{},lazyPlaceholder:{type:Boolean},delay:{},objectCover:{type:Boolean}},emits:[M,P],setup(a,{emit:e}){let u=a,l=K(re,{}),t=W({...u,...l}),o=e,d=f(null),p=f(null),i=f(!1),r=f(!1),s=c(()=>r.value?t.fallbackSrc:t.src),{isIntersected:n,watchIntersectionOnce:$}=oe(d),{loadImage:I,aspectRatio:_,width:B}=le(p),C=c(()=>!i.value),X=c(()=>({paddingBottom:`${_.value*100}%`})),Y=c(()=>{if(!(t.objectCover||B.value===0))return{maxWidth:`${B.value}px`}}),G=c(()=>[t.customClass,{"v-progressive-image-object-cover":t.objectCover,"v-progressive-image-loading":C.value}]);function F(v){let k=0;return typeof v=="string"?k=Number.parseInt(v):typeof v=="number"&&(k=v),k}function H(){I().then(()=>{setTimeout(()=>{i.value=!0,o(M)},F(t.delay))}).catch(v=>{i.value=!0,r.value=!0,o(P,v)})}return z(()=>{t.placeholderSrc&&t.blur&&document.documentElement.style.setProperty("--progressive-image-blur",`${F(t.blur)}px`),t.src&&$(H)}),(v,k)=>(m(),g("div",{ref_key:"rootRef",ref:d,class:R(["v-progressive-image",G.value]),style:h(Y.value)},[S("div",{style:h(X.value)},[T(D,{css:!t.placeholderSrc,name:"v-progressive-image-main-fade",appear:""},{default:b(()=>[w(n)?x((m(),g("img",{key:0,ref_key:"imageRef",ref:p,class:"v-progressive-image-main",src:s.value,alt:t.alt,title:t.title},null,8,se)),[[O,i.value]]):y("v-if",!0)]),_:1},8,["css"]),t.placeholderSrc?(m(),A(D,{key:0,name:"v-progressive-image-placeholder-fade",appear:""},{default:b(()=>[C.value?(m(),g("img",{key:0,alt:t.alt,class:"v-progressive-image-placeholder",loading:t.lazyPlaceholder?"lazy":"eager",src:t.placeholderSrc},null,8,ne)):y("v-if",!0)]),_:1})):y("v-if",!0),v.$slots.default?(m(),g("div",ie,[N(v.$slots,"default",{isLoading:C.value})])):y("v-if",!0)],4)],6))}}),ce=ue;const de={key:1,class:"absolute top-0 h-full w-full"},ve=j({__name:"SakuraImageCard",props:{src:{},to:{},alt:{},errorImg:{},scale:{default:1.2},rotate:{default:0},skewX:{default:0},skewY:{default:0},opacity:{default:1},translateX:{default:0},translateY:{default:0},transitionDuration:{default:"var(--va-transition-duration)"},transitionTimingFunction:{default:"ease"},overlay:{type:Boolean,default:!1},overlayColor:{default:"rgba(0, 0, 0, 0.5)"},overlayOpacity:{default:.5},overlayOpacityInitial:{default:0}},setup(a){const e=a,u=L(),l=f(!1),t=f(!1),o=c(()=>e.errorImg?E(e.errorImg):u.value?.notFoundImage),d=c(()=>l.value?{transform:`scale(${e.scale}) rotate(${e.rotate}deg) skew(${e.skewX}deg, ${e.skewY}deg) translate(${e.translateX}px, ${e.translateY}px)`,opacity:e.opacity,transition:`transform ${e.transitionDuration} ${e.transitionTimingFunction}, opacity ${e.transitionDuration} ${e.transitionTimingFunction}`}:{transition:`transform ${e.transitionDuration} ${e.transitionTimingFunction}, opacity ${e.transitionDuration} ${e.transitionTimingFunction}`}),p=c(()=>({opacity:l.value?e.overlayOpacity:e.overlayOpacityInitial,backgroundColor:e.overlayColor}));function i(s){const n=s.target;if(n.setAttribute("data-src",n.src),!o.value){t.value=!0;return}t.value=!1,n.src=o.value}const r=c(()=>{const s=e.src?E(e.src):"";return s&&s.includes("?random")?s.replace("?random",`?random=${Math.random()}`):s});return(s,n)=>{const $=Q("ClientOnly"),I=U;return m(),g("div",{class:"sakura-image-card relative overflow-hidden",onMouseover:n[0]||(n[0]=_=>l.value=!0),onMouseleave:n[1]||(n[1]=_=>l.value=!1)},[T(I,{flex:"~",w:"full",h:"full",to:e.to||"","aria-label":"Go to Post",class:R({"cursor-default":!e.to})},{default:b(()=>[T($,null,{default:b(()=>[r.value?x((m(),A(w(ce),{key:0,"custom-class":"sakura-image-card-img","lazy-placeholder":"",src:r.value,alt:e.alt||"cover",style:h(d.value),onError:i},null,8,["src","alt","style"])),[[O,!t.value]]):y("v-if",!0)]),_:1}),x(S("div",{class:"h-full w-full bg-$sakura-color-background opacity-70",style:h(d.value),flex:"~ center"},[...n[2]||(n[2]=[S("div",{"i-fa6-solid-image":"",w:"30%",h:"30%"},null,-1)])],4),[[O,t.value||!r.value]]),s.overlay?(m(),g("div",{key:0,class:"sakura-image-card-overlay",style:h(p.value)},null,4)):y("v-if",!0),s.$slots.default?(m(),g("div",de,[N(s.$slots,"default",{},void 0,!0)])):y("v-if",!0)]),_:3},8,["to","class"])],32)}}}),he=Z(ve,[["__scopeId","data-v-8692e20a"]]);export{he as _,ye as i,E as r};
